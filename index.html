<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>キングダム</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Yuji+Boku&display=swap" rel="stylesheet">
</head>

<body>
    <!-- メイン画面 -->
    <section class="fight-space">
        <img id="sin-f" src="./img/sin_flag.jpg">
        <img id="space"></img>
        <img id="busyo-1"></img>
        <img id="busyo-2"></img>
        <img id="busyo-3"></img>
        <img id="kizu-1" src="./img/kizu.png" style="visibility:hidden;">
        <img id="kizu-2" src="./img/kizu.png" style="visibility:hidden;">
        <img id="kizu-3" src="./img/kizu.png" style="visibility:hidden;">
        <img id="butai-1" style="visibility:hidden;"></img>
        <img id="butai-2" style="visibility:hidden;"></img>
        <img id="butai-3" style="visibility:hidden;"></img>
        <img id="teki-f" style="visibility:hidden;"></img>
        <img id="teki-1"></img>
        <img id="teki-2"></img>
        <img id="teki-3"></img>
        <img id="tkizu-1" src="./img/kizu.png" style="visibility:hidden;">
        <img id="tkizu-2" src="./img/kizu.png" style="visibility:hidden;">
        <img id="tkizu-3" src="./img/kizu.png" style="visibility:hidden;">
        <img id="t-butai-1" style="visibility:hidden;"></img>
        <img id="t-butai-2" style="visibility:hidden;"></img>
        <img id="t-butai-3" style="visibility:hidden;"></img>
        <img id="kaisen" class="fade0" src="./img/kaisen.jpg">
        <img id="syouri" class="fade0" src="./img/VEWOSP000003-removebg-preview.png">
        <img id="haiboku" class="fade0" src="./img/VEWOSP000004-removebg-preview.png">
        <p id="lf1-1" class="life1-1"></p>
        <p id="lf1-2" class="life1-2"></p>
        <p id="lf1-3" class="life1-3"></p>
        <p id="lf2-1" class="life2-1"></p>
        <p id="lf2-2" class="life2-2"></p>
        <p id="lf2-3" class="life2-3"></p>
        <p id="lf3-1" class="life3-1"></p>
        <p id="lf3-2" class="life3-2"></p>
        <p id="lf3-3" class="life3-3"></p>
        <p id="tlf1-1" class="tlife1-1"></p>
        <p id="tlf1-2" class="tlife1-2"></p>
        <p id="tlf1-3" class="tlife1-3"></p>
        <p id="tlf2-1" class="tlife2-1"></p>
        <p id="tlf2-2" class="tlife2-2"></p>
        <p id="tlf2-3" class="tlife2-3"></p>
        <p id="tlf3-1" class="tlife3-1"></p>
        <p id="tlf3-2" class="tlife3-2"></p>
        <p id="tlf3-3" class="tlife3-3"></p>
    </section>
    <!-- 会話画面 -->
    <div class="talk-space">
        <img class="syouheikun" src="./img/syouheikun.png">
        <div class="katari">
            <div class="balloon-left">
                <p id="talk">今回は大事な一戦となる！</p>
                <ul id="ul_sty" style="visibility:hidden;">
                    <li>
                        <input type="radio" name="s-tai" id="r1" value="1">
                        <label id="lab1" for="r1"></label>
                    </li>
                    <li>
                        <input type="radio" name="s-tai" id="r2" value="2">
                        <label id="lab2" for="r2"></label>
                    </li>
                    <li>
                        <input type="radio" name="s-tai" id="r3" value="3">
                        <label id="lab3" for="r3"></label>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- JavaScript開始 -->
    <script>
        let spaceArry = [
            "./img/sougen.jpg",
            "./img/siro.jpg",
            "./img/sangaku.jpg"
        ];
        let busyoArry1 = [
            "./img/sinkoku_ousen.jpeg",
            "./img/ouki-sinkoku.png",
            "./img/kanki-sinkoku.jpg"
        ];
        let busyoArry2 = [
            "./img/kansin-sinkoku.png",
            "./img/sinkoku_mouten.jpeg",
            "./img/sinkoku_hekisan.png"
        ];
        let busyoArry3 = [
            "./img/sinkoku_kyoukai.jpeg",
            "./img/sinkoku_ouhon.jpeg",
            "./img/sinkoku_tousan.jpeg"
        ];
        let butaiArry = [
            "./img/sword2-re.png",
            "./img/spear2-re.png",
            "./img/longbow2-re.png"
        ];
        let teki1Arry = [
            "./img/riboku.jpg",
            "./img/gokei.png",
        ];
        let teki2Arry = [
            "./img/tyoubusyo1.jpg",
            "./img/gibusyo1_.jpg",
        ];
        let teki3Arry = [
            "./img/tyoubusyo2.jpg",
            "./img/gibusyo2.png",
        ];
        let tekifArry = [
            "./img/tyou_flag.jpg",
            "./img/gi_flag.jpg",
        ];

        // 会話継続ボタン
        const talkbtn = document.getElementById("talk");

        // 戦場を決める
        const fspace = document.getElementById("space");

        //武将を決める
        const busyo1 = document.getElementById("busyo-1");
        const busyo2 = document.getElementById("busyo-2");
        const busyo3 = document.getElementById("busyo-3");

        //部隊を決める
        const butai1 = document.getElementById("butai-1");
        const butai2 = document.getElementById("butai-2");
        const butai3 = document.getElementById("butai-3");

        const ul_sty = document.getElementById("ul_sty");
        const rdbtn = document.getElementsByName("s-tai");
        const rdlen = rdbtn.length;
        const slab1 = document.getElementById("lab1");
        const slab2 = document.getElementById("lab2");
        const slab3 = document.getElementById("lab3");

        //敵国を決める
        const tflag = document.getElementById("teki-f");
        const tbusyo1 = document.getElementById("teki-1");
        const tbusyo2 = document.getElementById("teki-2");
        const tbusyo3 = document.getElementById("teki-3");
        const tbutai1 = document.getElementById("t-butai-1");
        const tbutai2 = document.getElementById("t-butai-2");
        const tbutai3 = document.getElementById("t-butai-3");
        const tekibtn = document.getElementById("teki-btn");

        //開戦ボタン
        const kaisenbtn = document.getElementById("kaisen");

        //生命力
        const slf11 = document.getElementById("lf1-1");
        const slf12 = document.getElementById("lf1-2");
        const slf13 = document.getElementById("lf1-3");
        const slf21 = document.getElementById("lf2-1");
        const slf22 = document.getElementById("lf2-2");
        const slf23 = document.getElementById("lf2-3");
        const slf31 = document.getElementById("lf3-1");
        const slf32 = document.getElementById("lf3-2");
        const slf33 = document.getElementById("lf3-3");

        const tlf11 = document.getElementById("tlf1-1");
        const tlf12 = document.getElementById("tlf1-2");
        const tlf13 = document.getElementById("tlf1-3");
        const tlf21 = document.getElementById("tlf2-1");
        const tlf22 = document.getElementById("tlf2-2");
        const tlf23 = document.getElementById("tlf2-3");
        const tlf31 = document.getElementById("tlf3-1");
        const tlf32 = document.getElementById("tlf3-2");
        const tlf33 = document.getElementById("tlf3-3");

        //ダメージ
        const dmg1 = document.getElementById("kizu-1");
        const dmg2 = document.getElementById("kizu-2");
        const dmg3 = document.getElementById("kizu-3");
        const tdmg1 = document.getElementById("tkizu-1");
        const tdmg2 = document.getElementById("tkizu-2");
        const tdmg3 = document.getElementById("tkizu-3");

        //勝利・敗北
        const syourimg = document.getElementById("syouri");
        const haibokuimg = document.getElementById("haiboku");



        //各種ステータス
        //攻撃力
        let s_atk = 0;
        let t_atk = 0;
        //防御力
        let s_def = 0;
        let t_def = 0;
        //武力
        let s1_pow = 0;
        let s2_pow = 0;
        let s3_pow = 0;
        let t1_pow = 0;
        let t2_pow = 0;
        let t3_pow = 0;
        //部隊の種類
        let s1_type = "";
        let s2_type = "";
        let s3_type = "";
        let t1_type = "";
        let t2_type = "";
        let t3_type = "";

        //生命力ゲージ
        let lifegage1 = 0;
        let lifegage2 = 0;
        let lifegage3 = 0;
        let tlifegage1 = 0;
        let tlifegage2 = 0;
        let tlifegage3 = 0;

        //初回フラグ
        let f_flag = 0;

        //会話回数
        let talk_cnt = 0;
        //ラジオボタンの値変数
        let rdval = "0";
        //会話ループ変数
        let talkloop = 0;

        //会話カウントイレギュラー防止フラグ
        let NG_flag = 0;

        //画像の初期設定
        fspace.src = spaceArry[0];
        busyo1.src = "./img/Honey-cam-bs.gif";
        busyo2.src = "./img/Honey-cam-bs.gif";
        busyo3.src = "./img/Honey-cam-bs.gif";

        tbusyo1.src = "./img/Honey-cam-bs.gif";
        tbusyo2.src = "./img/Honey-cam-bs.gif";
        tbusyo3.src = "./img/Honey-cam-bs.gif";

        // 各種設定を会話形式で決める
        talkbtn.addEventListener("click", function () {

            if (talk_cnt === 0) {
                talkbtn.textContent = "相手となる国は、";

                timerId = setInterval(() => {
                    let tekiIndex = Math.floor(Math.random() * tekifArry.length);
                    let tbutai1Index = Math.floor(Math.random() * butaiArry.length);
                    let tbutai2Index = Math.floor(Math.random() * butaiArry.length);
                    let tbutai3Index = Math.floor(Math.random() * butaiArry.length);
                    tflag.src = tekifArry[tekiIndex];
                    tflag.style.visibility = "visible";
                    tbusyo1.src = teki1Arry[tekiIndex];
                    tbusyo2.src = teki2Arry[tekiIndex];
                    tbusyo3.src = teki3Arry[tekiIndex];
                    tbutai1.src = butaiArry[tbutai1Index];
                    tbutai2.src = butaiArry[tbutai2Index];
                    tbutai3.src = butaiArry[tbutai3Index];
                }, 200);

            } else if (talk_cnt === 1) {
                clearInterval(timerId);

                //武将個々の能力を決める
                if (tflag.src.indexOf("gi_flag") > -1) {
                    //魏の場合
                    t1_pow = 3;
                    t2_pow = 2;
                    t3_pow = 1;
                    talkbtn.textContent = "魏の国となる。大将は呉鳳明になるだろう。心して懸かってほしい！";
                } else if (tflag.src.indexOf("tyou_flag") > -1) {
                    //趙の場合
                    t1_pow = 4;
                    t2_pow = 3;
                    t3_pow = 2;
                    talkbtn.textContent = "趙の国となる。大将は李牧になるだろう。心して懸かってほしい！";
                } else {
                }

                //各部隊の設定をする
                //中央
                if (tbutai1.src.indexOf("sword") > -1) {
                    //剣の場合
                    t1_type = "Ken";
                } else if (tbutai1.src.indexOf("spear") > -1) {
                    //槍の場合
                    t1_type = "Spe";
                } else if (tbutai1.src.indexOf("longbow") > -1) {
                    //弓の場合
                    t1_type = "Bow";
                } else {
                }
                //左翼
                if (tbutai2.src.indexOf("sword") > -1) {
                    //剣の場合
                    t2_type = "Ken";
                } else if (tbutai2.src.indexOf("spear") > -1) {
                    //槍の場合
                    t2_type = "Spe";
                } else if (tbutai2.src.indexOf("longbow") > -1) {
                    //弓の場合
                    t2_type = "Bow";
                } else {
                }
                //右翼
                if (tbutai3.src.indexOf("sword") > -1) {
                    //剣の場合
                    t3_type = "Ken";
                } else if (tbutai3.src.indexOf("spear") > -1) {
                    //槍の場合
                    t3_type = "Spe";
                } else if (tbutai3.src.indexOf("longbow") > -1) {
                    //弓の場合
                    t3_type = "Bow";
                } else {
                }

            } else if (talk_cnt === 2) {
                talkbtn.textContent = "続いて戦場だが";

                timerId = setInterval(() => {
                    let spaceIndex = Math.floor(Math.random() * spaceArry.length);
                    fspace.src = spaceArry[spaceIndex];
                }, 200);
            } else if (talk_cnt === 3) {
                clearInterval(timerId);

                //戦場による攻撃力と防御力を決める
                if (fspace.src.indexOf("sougen") > -1) {
                    //攻撃力
                    s_atk = 2;
                    t_atk = 1;

                    //防御力
                    s_def = 0;
                    t_def = 1;

                    talkbtn.textContent = "今回の相手の動きからみて、平原に陣を構えると予測される。";
                } else if (fspace.src.indexOf("siro") > -1) {
                    //攻撃力
                    s_atk = 1;
                    t_atk = -1;

                    //防御力
                    s_def = 0;
                    t_def = 2;

                    talkbtn.textContent = "今回の相手の動きからみて、籠城戦になると予測される。";
                } else if (fspace.src.indexOf("sangaku") > -1) {
                    //攻撃力
                    s_atk = 1;
                    t_atk = 2;

                    //防御力
                    s_def = 1;
                    t_def = 0;

                    talkbtn.textContent = "今回の相手の動きからみて、山岳地帯に陣を構えると予測される。";
                } else {
                }


            } else if (talk_cnt === 4) {

                talkbtn.textContent = "では今回、出撃してもらう者を発表する！";

                timerId = setInterval(() => {
                    let busyo1Index = Math.floor(Math.random() * busyoArry1.length);
                    let busyo2Index = Math.floor(Math.random() * busyoArry2.length);
                    let busyo3Index = Math.floor(Math.random() * busyoArry3.length);
                    busyo1.src = busyoArry1[busyo1Index];
                    busyo2.src = busyoArry2[busyo2Index];
                    busyo3.src = busyoArry3[busyo3Index];
                }, 200);
            } else if (talk_cnt === 5) {
                clearInterval(timerId);

                let serifu = "大将は、";

                //武将個々の能力を決める
                if (busyo1.src.indexOf("ousen") > -1) {
                    //武力
                    s1_pow = 3;
                    serifu = serifu + "王翦！";
                } else if (busyo1.src.indexOf("kanki") > -1) {
                    //武力
                    s1_pow = 3;
                    serifu = serifu + "桓騎！";
                } else if (busyo1.src.indexOf("ouki") > -1) {
                    //武力
                    s1_pow = 4;
                    serifu = serifu + "王騎！";
                } else {
                }

                if (busyo2.src.indexOf("kansin") > -1) {
                    //武力
                    s2_pow = 4;
                    serifu = serifu + "副将は李信と";
                } else if (busyo2.src.indexOf("mouten") > -1) {
                    //武力
                    s2_pow = 3;
                    serifu = serifu + "副将は蒙恬と";
                } else if (busyo2.src.indexOf("hekisan") > -1) {
                    //武力
                    s2_pow = 1;
                    serifu = serifu + "副将は壁と";
                } else {
                }

                if (busyo3.src.indexOf("kyoukai") > -1) {
                    //武力
                    s3_pow = 3;
                    serifu = serifu + "羌瘣とする！";
                } else if (busyo3.src.indexOf("ouhon") > -1) {
                    //武力
                    s3_pow = 3;
                    serifu = serifu + "王賁とする！";
                } else if (busyo3.src.indexOf("tousan") > -1) {
                    //武力
                    s3_pow = 4;
                    serifu = serifu + "騰とする！";
                } else {
                }

                talkbtn.textContent = serifu;

            } else if (talk_cnt === 6) {
                talkbtn.textContent = "各将は部隊編成に入るように！";
            } else if (talk_cnt === 7) {
                talkbtn.textContent = "大将の編成は。。？";
                slab1.textContent = "大将（中央）は剣部隊で編成";
                slab2.textContent = "大将（中央）は槍部隊で編成";
                slab3.textContent = "大将（中央）は弓部隊で編成";
                rdbtn[0].checked = true;
                ul_sty.style.visibility = "visible";
            } else if (talk_cnt === 8) {
                for (let i = 0; i < rdlen; i++) {
                    if (rdbtn.item(i).checked) {
                        rdval = rdbtn.item(i).value;
                    }
                }
                if (rdval === "1") {
                    butai1.src = butaiArry[0];
                    s1_type = "Ken";
                    butai1.style.visibility = "visible";
                } else if (rdval === "2") {
                    butai1.src = butaiArry[1];
                    s1_type = "Spe";
                    butai1.style.visibility = "visible";
                } else if (rdval === "3") {
                    butai1.src = butaiArry[2];
                    s1_type = "Bow";
                    butai1.style.visibility = "visible";
                } else {

                }
                talkbtn.textContent = "副将１人目の編成は。。？";
                slab1.textContent = "副将（左翼）は剣部隊で編成";
                slab2.textContent = "副将（左翼）は槍部隊で編成";
                slab3.textContent = "副将（左翼）は弓部隊で編成";
                rdbtn[0].checked = true;
            } else if (talk_cnt === 9) {
                for (let i = 0; i < rdlen; i++) {
                    if (rdbtn.item(i).checked) {
                        rdval = rdbtn.item(i).value;
                    }
                }
                if (rdval === "1") {
                    butai2.src = butaiArry[0];
                    s2_type = "Ken";
                    butai2.style.visibility = "visible";
                } else if (rdval === "2") {
                    butai2.src = butaiArry[1];
                    s2_type = "Spe";
                    butai2.style.visibility = "visible";
                } else if (rdval === "3") {
                    butai2.src = butaiArry[2];
                    s2_type = "Bow";
                    butai2.style.visibility = "visible";
                } else {

                }
                talkbtn.textContent = "副将２人目の編成は。。？";
                slab1.textContent = "副将（右翼）は剣部隊で編成";
                slab2.textContent = "副将（右翼）は槍部隊で編成";
                slab3.textContent = "副将（右翼）は弓部隊で編成";
                rdbtn[0].checked = true;
            } else if (talk_cnt === 10) {
                ul_sty.style.visibility = "hidden";
                for (let i = 0; i < rdlen; i++) {
                    if (rdbtn.item(i).checked) {
                        rdval = rdbtn.item(i).value;
                    }
                }
                if (rdval === "1") {
                    butai3.src = butaiArry[0];
                    s3_type = "Ken";
                    butai3.style.visibility = "visible";
                } else if (rdval === "2") {
                    butai3.src = butaiArry[1];
                    s3_type = "Spe";
                    butai3.style.visibility = "visible";
                } else if (rdval === "3") {
                    butai3.src = butaiArry[2];
                    s3_type = "Bow";
                    butai3.style.visibility = "visible";
                } else {

                }
                talkbtn.textContent = "よし！これで各将の編成も整ったな。では、む！";

            } else if (talk_cnt === 11) {
                talkbtn.textContent = "間者から情報が入り、敵将の編成がわかったようだ。";
                tbutai1.style.visibility = "visible";
                tbutai2.style.visibility = "visible";
                tbutai3.style.visibility = "visible";
            } else if (talk_cnt === 12) {
                talkbtn.textContent = "では、今度こそ準備が整った！　各将出陣せよ！（開戦ボタンを押して開始してください。）";
                kaisenbtn.classList.replace("fade0", "fade");
                NG_flag = 1;
                //ここから下は勝負が着くまでループ
            } else if (talk_cnt === 13 + 4 * talkloop) {
                talkbtn.textContent = "大将の編成を変更するか？";
                if (s1_type === "Ken") {
                    rdbtn[0].checked = true;
                    slab1.textContent = "大将（中央）は変わらず剣部隊で行く";
                    slab2.textContent = "大将（中央）は槍部隊に変更する";
                    slab3.textContent = "大将（中央）は弓部隊に変更する";
                } else if (s1_type === "Spe") {
                    rdbtn[1].checked = true;
                    slab1.textContent = "大将（中央）は剣部隊に変更する";
                    slab2.textContent = "大将（中央）は変わらず槍部隊で行く";
                    slab3.textContent = "大将（中央）は弓部隊に変更する";
                } else if (s1_type === "Bow") {
                    rdbtn[2].checked = true;
                    slab1.textContent = "大将（中央）は剣部隊に変更する";
                    slab2.textContent = "大将（中央）は槍部隊に変更する";
                    slab3.textContent = "大将（中央）は変わらず弓部隊で行く";
                }
                ul_sty.style.visibility = "visible";
            } else if (talk_cnt === 14 + 4 * talkloop) {
                for (let i = 0; i < rdlen; i++) {
                    if (rdbtn.item(i).checked) {
                        rdval = rdbtn.item(i).value;
                    }
                }
                if (rdval === "1") {
                    butai1.src = butaiArry[0];
                    s1_type = "Ken";
                } else if (rdval === "2") {
                    butai1.src = butaiArry[1];
                    s1_type = "Spe";
                } else if (rdval === "3") {
                    butai1.src = butaiArry[2];
                    s1_type = "Bow";
                } else {

                }
                talkbtn.textContent = "副将の編成を変更するか？";

                if (s2_type === "Ken") {
                    rdbtn[0].checked = true;
                    slab1.textContent = "副将（左翼）は変わらず剣部隊で行く";
                    slab2.textContent = "副将（左翼）は槍部隊に変更する";
                    slab3.textContent = "副将（左翼）は弓部隊に変更する";
                } else if (s2_type === "Spe") {
                    rdbtn[1].checked = true;
                    slab1.textContent = "副将（左翼）は剣部隊に変更する";
                    slab2.textContent = "副将（左翼）は変わらず槍部隊で行く";
                    slab3.textContent = "副将（左翼）は弓部隊に変更する";
                } else if (s2_type === "Bow") {
                    rdbtn[2].checked = true;
                    slab1.textContent = "副将（左翼）は剣部隊に変更する";
                    slab2.textContent = "副将（左翼）は槍部隊に変更する";
                    slab3.textContent = "副将（左翼）は変わらず弓部隊で行く";
                }
            } else if (talk_cnt === 15 + 4 * talkloop) {
                for (let i = 0; i < rdlen; i++) {
                    if (rdbtn.item(i).checked) {
                        rdval = rdbtn.item(i).value;
                    }
                }
                if (rdval === "1") {
                    butai2.src = butaiArry[0];
                    s2_type = "Ken";
                } else if (rdval === "2") {
                    butai2.src = butaiArry[1];
                    s2_type = "Spe";
                } else if (rdval === "3") {
                    butai2.src = butaiArry[2];
                    s2_type = "Bow";
                } else {

                }
                talkbtn.textContent = "副将の編成を変更するか？";

                if (s3_type === "Ken") {
                    rdbtn[0].checked = true;
                    slab1.textContent = "副将（右翼）は変わらず剣部隊で行く";
                    slab2.textContent = "副将（右翼）は槍部隊に変更する";
                    slab3.textContent = "副将（右翼）は弓部隊に変更する";
                } else if (s3_type === "Spe") {
                    rdbtn[1].checked = true;
                    slab1.textContent = "副将（右翼）は剣部隊に変更する";
                    slab2.textContent = "副将（右翼）は変わらず槍部隊で行く";
                    slab3.textContent = "副将（右翼）は弓部隊に変更する";
                } else if (s3_type === "Bow") {
                    rdbtn[2].checked = true;
                    slab1.textContent = "副将（右翼）は剣部隊に変更する";
                    slab2.textContent = "副将（右翼）は槍部隊に変更する";
                    slab3.textContent = "副将（右翼）は変わらず弓部隊で行く";
                }
            } else if (talk_cnt === 16 + 4 * talkloop) {
                ul_sty.style.visibility = "hidden";
                for (let i = 0; i < rdlen; i++) {
                    if (rdbtn.item(i).checked) {
                        rdval = rdbtn.item(i).value;
                    }
                }
                if (rdval === "1") {
                    butai3.src = butaiArry[0];
                    s3_type = "Ken";
                } else if (rdval === "2") {
                    butai3.src = butaiArry[1];
                    s3_type = "Spe";
                } else if (rdval === "3") {
                    butai3.src = butaiArry[2];
                    s3_type = "Bow";
                } else {

                }
                talkbtn.textContent = "今日こそは勝つぞ！（開戦ボタンを押してください。）";
                kaisenbtn.classList.replace("fade0", "fade");
                NG_flag = 1;
                //ここからは戦後処理
            } else if (talk_cnt === 1000) {
                talkbtn.textContent = "今回は残念でした！再戦をお待ちしております！";
            } else if (talk_cnt === 2000) {
                talkbtn.textContent = "おめでとうございます！次のチャレンジお待ちしております！";
            } else if (talk_cnt === 1001 || talk_cnt === 2001) {
                //最初に戻る
                talkbtn.textContent = "今回は大事な一戦となる！";

                //各種初期設定に戻す
                //各種ステータス
                //攻撃力
                s_atk = 0;
                t_atk = 0;
                //防御力
                s_def = 0;
                t_def = 0;
                //武力
                s1_pow = 0;
                s2_pow = 0;
                s3_pow = 0;
                t1_pow = 0;
                t2_pow = 0;
                t3_pow = 0;
                //部隊の種類
                s1_type = "";
                s2_type = "";
                s3_type = "";
                t1_type = "";
                t2_type = "";
                t3_type = "";

                //生命力ゲージ
                lifegage1 = 0;
                lifegage2 = 0;
                lifegage3 = 0;
                tlifegage1 = 0;
                tlifegage2 = 0;
                tlifegage3 = 0;

                //初回フラグ
                f_flag = 0;

                //会話回数
                talk_cnt = -1;
                //ラジオボタンの値変数
                rdval = "0";
                //会話ループ変数
                talkloop = 0;

                NG_flag = 0;

                fspace.src = spaceArry[0];
                tbusyo1.classList.remove("red");
                tbusyo2.classList.remove("red");
                tbusyo3.classList.remove("red");
                busyo1.classList.remove("red");
                busyo2.classList.remove("red");
                busyo3.classList.remove("red");

                busyo1.src = "./img/Honey-cam-bs.gif";
                busyo2.src = "./img/Honey-cam-bs.gif";
                busyo3.src = "./img/Honey-cam-bs.gif";

                tbusyo1.src = "./img/Honey-cam-bs.gif";
                tbusyo2.src = "./img/Honey-cam-bs.gif";
                tbusyo3.src = "./img/Honey-cam-bs.gif";

                tflag.style.visibility = "hidden";

                butai1.style.visibility = "hidden";
                butai2.style.visibility = "hidden";
                butai3.style.visibility = "hidden";
                tbutai1.style.visibility = "hidden";
                tbutai2.style.visibility = "hidden";
                tbutai3.style.visibility = "hidden";

                haibokuimg.classList.replace("fade", "fade0");
                syourimg.classList.replace("fade", "fade0");

                tlf11.classList.replace("tlost1-1", "tlife1-1");
                tlf12.classList.replace("tlost1-2", "tlife1-2");
                tlf13.classList.replace("tlost1-3", "tlife1-3");
                tlf21.classList.replace("tlost2-1", "tlife2-1");
                tlf22.classList.replace("tlost2-2", "tlife2-2");
                tlf23.classList.replace("tlost2-3", "tlife2-3");
                tlf31.classList.replace("tlost3-1", "tlife3-1");
                tlf32.classList.replace("tlost3-2", "tlife3-2");
                tlf33.classList.replace("tlost3-3", "tlife3-3");

                slf11.classList.replace("lost1-1", "life1-1");
                slf12.classList.replace("lost1-2", "life1-2");
                slf13.classList.replace("lost1-3", "life1-3");
                slf21.classList.replace("lost2-1", "life2-1");
                slf22.classList.replace("lost2-2", "life2-2");
                slf23.classList.replace("lost2-3", "life2-3");
                slf31.classList.replace("lost3-1", "life3-1");
                slf32.classList.replace("lost3-2", "life3-2");
                slf33.classList.replace("lost3-3", "life3-3");
            }
            if (NG_flag === 0) {
                talk_cnt++;
            }
        });

        //開戦処理
        kaisenbtn.addEventListener("click", function () {
            //2回目以降処理
            if (f_flag > 0) {
                let t2butai1Index = Math.floor(Math.random() * butaiArry.length);
                let t2butai2Index = Math.floor(Math.random() * butaiArry.length);
                let t2butai3Index = Math.floor(Math.random() * butaiArry.length);
                tbutai1.src = butaiArry[t2butai1Index];
                tbutai2.src = butaiArry[t2butai2Index];
                tbutai3.src = butaiArry[t2butai3Index];

                //各部隊の設定をする
                //中央
                if (tbutai1.src.indexOf("sword") > -1) {
                    //剣の場合
                    t1_type = "Ken";
                } else if (tbutai1.src.indexOf("spear") > -1) {
                    //槍の場合
                    t1_type = "Spe";
                } else if (tbutai1.src.indexOf("longbow") > -1) {
                    //弓の場合
                    t1_type = "Bow";
                } else {
                }
                //左翼
                if (tbutai2.src.indexOf("sword") > -1) {
                    //剣の場合
                    t2_type = "Ken";
                } else if (tbutai2.src.indexOf("spear") > -1) {
                    //槍の場合
                    t2_type = "Spe";
                } else if (tbutai2.src.indexOf("longbow") > -1) {
                    //弓の場合
                    t2_type = "Bow";
                } else {
                }
                //右翼
                if (tbutai3.src.indexOf("sword") > -1) {
                    //剣の場合
                    t3_type = "Ken";
                } else if (tbutai3.src.indexOf("spear") > -1) {
                    //槍の場合
                    t3_type = "Spe";
                } else if (tbutai3.src.indexOf("longbow") > -1) {
                    //弓の場合
                    t3_type = "Bow";
                } else {
                }
                //会話ループカウントアップ
                talkloop++;
            }

            //初期設定
            let s_t1_atk = 0;
            let s_t2_atk = 0;
            let s_t3_atk = 0;
            let s_t1_def = 0;
            let s_t2_def = 0;
            let s_t3_def = 0;
            let t_t1_atk = 0;
            let t_t2_atk = 0;
            let t_t3_atk = 0;
            let t_t1_def = 0;
            let t_t2_def = 0;
            let t_t3_def = 0;
            //敵味方の攻撃・防御処理
            //中央（１）
            if (s1_type === "Ken") {
                if (t1_type === "Ken") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow + 0;
                    t_t1_atk = t_atk + t1_pow + 0;
                    //合計防御力
                    s_t1_def = s_def + s1_pow + 0;
                    t_t1_def = t_def + s1_pow + 0;
                } else if (t1_type === "Spe") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow - 2;
                    t_t1_atk = t_atk + t1_pow + 2;
                    //合計防御力
                    s_t1_def = s_def + s1_pow - 1;
                    t_t1_def = t_def + s1_pow + 1;
                } else if (t1_type === "Bow") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow + 2;
                    t_t1_atk = t_atk + t1_pow - 2;
                    //合計防御力
                    s_t1_def = s_def + s1_pow + 1;
                    t_t1_def = t_def + s1_pow - 1;
                } else {
                }
            } else if (s1_type === "Spe") {
                if (t1_type === "Ken") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow + 2;
                    t_t1_atk = t_atk + t1_pow - 2;
                    //合計防御力
                    s_t1_def = s_def + s1_pow + 1;
                    t_t1_def = t_def + s1_pow - 1;
                } else if (t1_type === "Spe") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow + 0;
                    t_t1_atk = t_atk + t1_pow + 0;
                    //合計防御力
                    s_t1_def = s_def + s1_pow + 0;
                    t_t1_def = t_def + s1_pow + 0;
                } else if (t1_type === "Bow") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow - 2;
                    t_t1_atk = t_atk + t1_pow + 2;
                    //合計防御力
                    s_t1_def = s_def + s1_pow - 1;
                    t_t1_def = t_def + s1_pow + 1;
                } else {
                }
            } else if (s1_type === "Bow") {
                if (t1_type === "Ken") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow - 2;
                    t_t1_atk = t_atk + t1_pow + 2;
                    //合計防御力
                    s_t1_def = s_def + s1_pow - 1;
                    t_t1_def = t_def + s1_pow + 1;
                } else if (t1_type === "Spe") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow + 2;
                    t_t1_atk = t_atk + t1_pow - 2;
                    //合計防御力
                    s_t1_def = s_def + s1_pow + 1;
                    t_t1_def = t_def + s1_pow - 1;
                } else if (t1_type === "Bow") {
                    //合計攻撃力
                    s_t1_atk = s_atk + s1_pow + 0;
                    t_t1_atk = t_atk + t1_pow + 0;
                    //合計防御力
                    s_t1_def = s_def + s1_pow + 0;
                    t_t1_def = t_def + s1_pow + 0;
                } else {
                }
            } else {
            }

            //左翼（２）
            if (s2_type === "Ken") {
                if (t2_type === "Ken") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow + 0;
                    t_t2_atk = t_atk + t2_pow + 0;
                    //合計防御力
                    s_t2_def = s_def + s2_pow + 0;
                    t_t2_def = t_def + s2_pow + 0;
                } else if (t2_type === "Spe") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow - 2;
                    t_t2_atk = t_atk + t2_pow + 2;
                    //合計防御力
                    s_t2_def = s_def + s2_pow - 1;
                    t_t2_def = t_def + s2_pow + 1;
                } else if (t2_type === "Bow") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow + 2;
                    t_t2_atk = t_atk + t2_pow - 2;
                    //合計防御力
                    s_t2_def = s_def + s2_pow + 1;
                    t_t2_def = t_def + s2_pow - 1;
                } else {
                }
            } else if (s2_type === "Spe") {
                if (t2_type === "Ken") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow + 2;
                    t_t2_atk = t_atk + t2_pow - 2;
                    //合計防御力
                    s_t2_def = s_def + s2_pow + 1;
                    t_t2_def = t_def + s2_pow - 1;
                } else if (t2_type === "Spe") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow + 0;
                    t_t2_atk = t_atk + t2_pow + 0;
                    //合計防御力
                    s_t2_def = s_def + s2_pow + 0;
                    t_t2_def = t_def + s2_pow + 0;
                } else if (t2_type === "Bow") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow - 2;
                    t_t2_atk = t_atk + t2_pow + 2;
                    //合計防御力
                    s_t2_def = s_def + s2_pow - 1;
                    t_t2_def = t_def + s2_pow + 1;
                } else {
                }
            } else if (s2_type === "Bow") {
                if (t2_type === "Ken") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow - 2;
                    t_t2_atk = t_atk + t2_pow + 2;
                    //合計防御力
                    s_t2_def = s_def + s2_pow - 1;
                    t_t2_def = t_def + s2_pow + 1;
                } else if (t2_type === "Spe") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow + 2;
                    t_t2_atk = t_atk + t2_pow - 2;
                    //合計防御力
                    s_t2_def = s_def + s2_pow + 1;
                    t_t2_def = t_def + s2_pow - 1;
                } else if (t2_type === "Bow") {
                    //合計攻撃力
                    s_t2_atk = s_atk + s2_pow + 0;
                    t_t2_atk = t_atk + t2_pow + 0;
                    //合計防御力
                    s_t2_def = s_def + s2_pow + 0;
                    t_t2_def = t_def + s2_pow + 0;
                } else {
                }
            } else {
            }

            //右翼（３）
            if (s3_type === "Ken") {
                if (t3_type === "Ken") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow + 0;
                    t_t3_atk = t_atk + t3_pow + 0;
                    //合計防御力
                    s_t3_def = s_def + s3_pow + 0;
                    t_t3_def = t_def + s3_pow + 0;
                } else if (t3_type === "Spe") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow - 2;
                    t_t3_atk = t_atk + t3_pow + 2;
                    //合計防御力
                    s_t3_def = s_def + s3_pow - 1;
                    t_t3_def = t_def + s3_pow + 1;
                } else if (t3_type === "Bow") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow + 2;
                    t_t3_atk = t_atk + t3_pow - 2;
                    //合計防御力
                    s_t3_def = s_def + s3_pow + 1;
                    t_t3_def = t_def + s3_pow - 1;
                } else {
                }
            } else if (s3_type === "Spe") {
                if (t3_type === "Ken") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow + 2;
                    t_t3_atk = t_atk + t3_pow - 2;
                    //合計防御力
                    s_t3_def = s_def + s3_pow + 1;
                    t_t3_def = t_def + s3_pow - 1;
                } else if (t3_type === "Spe") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow + 0;
                    t_t3_atk = t_atk + t3_pow + 0;
                    //合計防御力
                    s_t3_def = s_def + s3_pow + 0;
                    t_t3_def = t_def + s3_pow + 0;
                } else if (t3_type === "Bow") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow - 2;
                    t_t3_atk = t_atk + t3_pow + 2;
                    //合計防御力
                    s_t3_def = s_def + s3_pow - 1;
                    t_t3_def = t_def + s3_pow + 1;
                } else {
                }
            } else if (s3_type === "Bow") {
                if (t3_type === "Ken") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow - 2;
                    t_t3_atk = t_atk + t3_pow + 2;
                    //合計防御力
                    s_t3_def = s_def + s3_pow - 1;
                    t_t3_def = t_def + s3_pow + 1;
                } else if (t3_type === "Spe") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow + 2;
                    t_t3_atk = t_atk + t3_pow - 2;
                    //合計防御力
                    s_t3_def = s_def + s3_pow + 1;
                    t_t3_def = t_def + s3_pow - 1;
                } else if (t3_type === "Bow") {
                    //合計攻撃力
                    s_t3_atk = s_atk + s3_pow + 0;
                    t_t3_atk = t_atk + t3_pow + 0;
                    //合計防御力
                    s_t3_def = s_def + s3_pow + 0;
                    t_t3_def = t_def + s3_pow + 0;
                } else {
                }
            } else {
            }

            //攻防処理
            //味方の攻撃（中央）
            if (s_t1_atk - t_t1_def > 0) {
                //敵にダメージ
                if (tlifegage1 === 0) {
                    //ダメージ１
                    tdmg1.style.visibility = "visible";
                    tlf11.classList.replace("tlife1-1", "tlost1-1");
                    window.setTimeout(function () {
                        tdmg1.style.visibility = "hidden";
                    }, 500);
                    tlifegage1++;
                } else if (tlifegage1 === 1) {
                    //ダメージ２
                    tdmg1.style.visibility = "visible";
                    tlf12.classList.replace("tlife1-2", "tlost1-2");
                    window.setTimeout(function () {
                        tdmg1.style.visibility = "hidden";
                    }, 500);
                    tlifegage1++;
                } else if (tlifegage1 === 2) {
                    //やられる
                    tdmg1.style.visibility = "visible";
                    tlf13.classList.replace("tlife1-3", "tlost1-3");
                    window.setTimeout(function () {
                        tdmg1.style.visibility = "hidden";
                        tbusyo1.classList.add("red");
                    }, 500);
                    tlifegage1++;
                }
            } else {
            }
            //敵の攻撃（中央）
            if (t_t1_atk - s_t1_def > 0) {
                //味方にダメージ
                if (lifegage1 === 0) {
                    //ダメージ１
                    dmg1.style.visibility = "visible";
                    slf11.classList.replace("life1-1", "lost1-1");
                    window.setTimeout(function () {
                        dmg1.style.visibility = "hidden";
                    }, 500);
                    lifegage1++;
                } else if (lifegage1 === 1) {
                    //ダメージ２
                    dmg1.style.visibility = "visible";
                    slf12.classList.replace("life1-2", "lost1-2");
                    window.setTimeout(function () {
                        dmg1.style.visibility = "hidden";
                    }, 500);
                    lifegage1++;
                } else if (lifegage1 === 2) {
                    //やられる
                    dmg1.style.visibility = "visible";
                    slf13.classList.replace("life1-3", "lost1-3");
                    window.setTimeout(function () {
                        dmg1.style.visibility = "hidden";
                        busyo1.classList.add("red");
                    }, 500);
                    lifegage1++;
                }
            } else {
            }

            //味方の攻撃（左翼）
            if (s_t2_atk - t_t2_def > 0) {
                //敵にダメージ
                if (tlifegage2 === 0) {
                    tdmg2.style.visibility = "visible";
                    tlf21.classList.replace("tlife2-1", "tlost2-1");
                    window.setTimeout(function () {
                        tdmg2.style.visibility = "hidden";
                    }, 500);
                    tlifegage2++;
                } else if (tlifegage2 === 1) {
                    tdmg2.style.visibility = "visible";
                    tlf22.classList.replace("tlife2-2", "tlost2-2");
                    window.setTimeout(function () {
                        tdmg2.style.visibility = "hidden";
                    }, 500);
                    tlifegage2++;
                } else if (tlifegage2 === 2) {
                    tdmg2.style.visibility = "visible";
                    tlf23.classList.replace("tlife2-3", "tlost2-3");
                    window.setTimeout(function () {
                        tdmg2.style.visibility = "hidden";
                        tbusyo2.classList.add("red");
                    }, 500);
                    tlifegage2++;
                }
            } else {
            }
            //敵の攻撃（左翼）
            if (t_t2_atk - s_t2_def > 0) {
                //味方にダメージ
                if (lifegage2 === 0) {
                    dmg2.style.visibility = "visible";
                    slf21.classList.replace("life2-1", "lost2-1");
                    window.setTimeout(function () {
                        dmg2.style.visibility = "hidden";
                    }, 500);
                    lifegage2++;
                } else if (lifegage2 === 1) {
                    dmg2.style.visibility = "visible";
                    slf22.classList.replace("life2-2", "lost2-2");
                    window.setTimeout(function () {
                        dmg2.style.visibility = "hidden";
                    }, 500);
                    lifegage2++;
                } else if (lifegage2 === 2) {
                    dmg2.style.visibility = "visible";
                    slf23.classList.replace("life2-3", "lost2-3");
                    window.setTimeout(function () {
                        dmg2.style.visibility = "hidden";
                        busyo2.classList.add("red");
                    }, 500);
                    lifegage2++;
                }
            } else {
            }

            //味方の攻撃（右翼）
            if (s_t3_atk - t_t3_def > 0) {
                //敵にダメージ
                if (tlifegage3 === 0) {
                    tdmg3.style.visibility = "visible";
                    tlf31.classList.replace("tlife3-1", "tlost3-1");
                    window.setTimeout(function () {
                        tdmg3.style.visibility = "hidden";
                    }, 500);
                    tlifegage3++;
                } else if (tlifegage3 === 1) {
                    tdmg3.style.visibility = "visible";
                    tlf32.classList.replace("tlife3-2", "tlost3-2");
                    window.setTimeout(function () {
                        tdmg3.style.visibility = "hidden";
                    }, 500);
                    tlifegage3++;
                } else if (tlifegage3 === 2) {
                    tdmg3.style.visibility = "visible";
                    tlf33.classList.replace("tlife3-3", "tlost3-3");
                    window.setTimeout(function () {
                        tdmg3.style.visibility = "hidden";
                        tbusyo3.classList.add("red");
                    }, 500);
                    tlifegage3++;
                }
            } else {
            }
            //敵の攻撃（右翼）
            if (t_t3_atk - s_t3_def > 0) {
                //味方にダメージ
                if (lifegage3 === 0) {
                    dmg3.style.visibility = "visible";
                    slf31.classList.replace("life3-1", "lost3-1");
                    window.setTimeout(function () {
                        dmg3.style.visibility = "hidden";
                    }, 500);
                    lifegage3++;
                } else if (lifegage3 === 1) {
                    dmg3.style.visibility = "visible";
                    slf32.classList.replace("life3-2", "lost3-2");
                    window.setTimeout(function () {
                        dmg3.style.visibility = "hidden";
                    }, 500);
                    lifegage3++;
                } else if (lifegage3 === 2) {
                    dmg3.style.visibility = "visible";
                    slf33.classList.replace("life3-3", "lost3-3");
                    window.setTimeout(function () {
                        dmg3.style.visibility = "hidden";
                        busyo3.classList.add("red");
                    }, 500);
                    lifegage3++;
                }
            } else {
            }

            //会話カウントアップOK
            NG_flag = 0;
            talk_cnt++;

            //決着判定
            if (lifegage1 + lifegage2 === 6 || lifegage2 + lifegage3 === 6 || lifegage1 + lifegage3 === 6) {
                if (tlifegage1 + tlifegage2 === 6 || tlifegage2 + tlifegage3 === 6 || tlifegage1 + tlifegage3 === 6) {
                    //引き分け
                    kaisenbtn.classList.replace("fade", "fade0");
                    talkbtn.textContent = "これ以上はお互い消耗戦になるだけだ。。痛み分けだな。。敵の動きを見ながら退却せよ。";
                } else {
                    //味方の負け
                    kaisenbtn.classList.replace("fade", "fade0");
                    haibokuimg.classList.replace("fade0", "fade");
                    talkbtn.textContent = "今回は負けだ。。本国まで退却せよ。。。";
                }
                talk_cnt = 1000;
            } else if (tlifegage1 + tlifegage2 === 6 || tlifegage2 + tlifegage3 === 6 || tlifegage1 + tlifegage3 === 6) {
                //味方の勝ち
                kaisenbtn.classList.replace("fade", "fade0");
                syourimg.classList.replace("fade0", "fade");
                talkbtn.textContent = "敵が退却していくぞ。我々の勝利だ！！勝鬨を上げろ！！！";
                talk_cnt = 2000;
            } else {
                //勝敗がつかない場合（ループ処理へ）
                //カウントアップ
                f_flag++;

                //開戦ボタンを隠す
                kaisenbtn.classList.replace("fade", "fade0");
                talkbtn.textContent = "今日はここまでだ！体勢を立て直す。戻れ！";
            }
        });
    </script>
</body>

</html>